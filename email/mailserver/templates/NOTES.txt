ğŸš€ Mailstack dÃ©ployÃ© avec succÃ¨s!

ğŸ“§ Configuration de votre serveur de messagerie:
--------------------------------------------------

ğŸ“ Namespace: {{ .Values.global.namespace }}
ğŸŒ Domaine: {{ .Values.global.domain }}

ğŸ“¦ Services dÃ©ployÃ©s:
--------------------------------------------------

{{- if .Values.mailserver.enabled }}
âœ… Serveur Mail (docker-mailserver):
   - RÃ©pliques: {{ .Values.mailserver.replicaCount }}
   - Ports:
     * SMTP: {{ .Values.mailserver.ports.smtp }}
     * IMAP: {{ .Values.mailserver.ports.imap }}
     * Submission: {{ .Values.mailserver.ports.submission }}
     * IMAPS: {{ .Values.mailserver.ports.imaps }}
     * SMTPS: {{ .Values.mailserver.ports.smtps }}

ğŸ“§ Comptes email configurÃ©s:
{{- range .Values.mailserver.accounts }}
   - {{ .email }}
{{- end }}

{{- if .Values.mailserver.aliases }}
ğŸ“§ Alias configurÃ©s:
{{- range .Values.mailserver.aliases }}
   - {{ .alias }} â†’ {{ .target }}
{{- end }}
{{- end }}
{{- end }}

{{- if .Values.roundcube.enabled }}
{{- if .Values.roundcube.instance1.enabled }}
âœ… Roundcube Instance 1:
   - Service: {{ .Values.roundcube.instance1.name }}
   - RÃ©pliques: {{ .Values.roundcube.instance1.replicaCount }}
   {{- if eq .Values.roundcube.instance1.service.type "NodePort" }}
   - URL: http://<NODE-IP>:{{ .Values.roundcube.instance1.service.nodePort }}
   {{- else }}
   - Port: {{ .Values.roundcube.instance1.service.port }}
   {{- end }}
{{- end }}

{{- if .Values.roundcube.instance2.enabled }}
âœ… Roundcube Instance 2:
   - Service: {{ .Values.roundcube.instance2.name }}
   - RÃ©pliques: {{ .Values.roundcube.instance2.replicaCount }}
   {{- if eq .Values.roundcube.instance2.service.type "NodePort" }}
   - URL: http://<NODE-IP>:{{ .Values.roundcube.instance2.service.nodePort }}
   {{- else }}
   - Port: {{ .Values.roundcube.instance2.service.port }}
   {{- end }}
{{- end }}
{{- end }}

ğŸ”§ Commandes utiles:
--------------------------------------------------

1. VÃ©rifier le statut des pods:
   kubectl get pods -n {{ .Values.global.namespace }}

2. Voir les logs du serveur mail:
   kubectl logs -n {{ .Values.global.namespace }} deployment/mailserver

3. Voir les logs de Roundcube:
   {{- if .Values.roundcube.instance1.enabled }}
   kubectl logs -n {{ .Values.global.namespace }} deployment/{{ .Values.roundcube.instance1.name }}
   {{- end }}
   {{- if .Values.roundcube.instance2.enabled }}
   kubectl logs -n {{ .Values.global.namespace }} deployment/{{ .Values.roundcube.instance2.name }}
   {{- end }}

4. AccÃ©der au shell du serveur mail:
   kubectl exec -it -n {{ .Values.global.namespace }} deployment/mailserver -- /bin/bash

5. VÃ©rifier les services:
   kubectl get svc -n {{ .Values.global.namespace }}

6. VÃ©rifier les PVCs:
   kubectl get pvc -n {{ .Values.global.namespace }}

ğŸŒ AccÃ¨s aux services:
--------------------------------------------------

{{- if .Values.roundcube.enabled }}
{{- if .Values.roundcube.instance1.enabled }}
{{- if eq .Values.roundcube.instance1.service.type "NodePort" }}
â€¢ Roundcube Instance 1: http://<NODE-IP>:{{ .Values.roundcube.instance1.service.nodePort }}
{{- else }}
â€¢ Roundcube Instance 1: Port-forward avec: kubectl port-forward -n {{ .Values.global.namespace }} svc/{{ .Values.roundcube.instance1.name }} 8080:80
  Puis accÃ¨s via: http://localhost:8080
{{- end }}
{{- end }}

{{- if .Values.roundcube.instance2.enabled }}
{{- if eq .Values.roundcube.instance2.service.type "NodePort" }}
â€¢ Roundcube Instance 2: http://<NODE-IP>:{{ .Values.roundcube.instance2.service.nodePort }}
{{- else }}
â€¢ Roundcube Instance 2: Port-forward avec: kubectl port-forward -n {{ .Values.global.namespace }} svc/{{ .Values.roundcube.instance2.name }} 8081:80
  Puis accÃ¨s via: http://localhost:8081
{{- end }}
{{- end }}
{{- end }}

ğŸ“ Configuration client email (IMAP/SMTP):
--------------------------------------------------
â€¢ Serveur IMAP: mailserver.{{ .Values.global.namespace }}.svc.cluster.local:{{ .Values.mailserver.ports.imap }}
â€¢ Serveur SMTP: mailserver.{{ .Values.global.namespace }}.svc.cluster.local:{{ .Values.mailserver.ports.submission }}

âš ï¸  Note importante:
--------------------------------------------------
â€¢ Le serveur mail utilise des certificats auto-signÃ©s par dÃ©faut
â€¢ Pour la production, configurez des certificats SSL valides
â€¢ Assurez-vous que les ports nÃ©cessaires sont ouverts sur votre cluster

ğŸ” DÃ©pannage:
--------------------------------------------------
En cas de problÃ¨me, vÃ©rifiez:
1. Les logs des pods
2. Les Ã©vÃ©nements: kubectl get events -n {{ .Values.global.namespace }}
3. La connectivitÃ© rÃ©seau entre les services
4. Les volumes persistants

ğŸ“š Documentation:
--------------------------------------------------
â€¢ docker-mailserver: https://docker-mailserver.github.io/docker-mailserver/latest/
â€¢ Roundcube: https://roundcube.net/

Bon usage de votre serveur de messagerie! ğŸ“¬
